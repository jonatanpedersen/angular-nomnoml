!function(e,n){function t(e){return{restrict:"A",scope:{nomnomlSource:"@"},link:function(t,i){function o(e){return{arrowSize:+e.arrowSize||1,bendSize:+e.bendSize||.3,direction:{down:"TB",right:"LR"}[e.direction]||"TB",gutter:+e.gutter||5,edgeMargin:+e.edgeMargin||0,edges:{hard:"hard",rounded:"rounded"}[e.edges]||"rounded",fill:(e.fill||"#eee8d5;#fdf6e3;#eee8d5;#fdf6e3").split(";"),fillArrows:"true"===e.fillArrows,font:e.font||"Calibri",fontSize:+e.fontSize||12,leading:+e.leading||1.25,lineWidth:+e.lineWidth||3,padding:+e.padding||8,spacing:+e.spacing||40,stroke:e.stroke||"#33322E",zoom:+e.zoom||1}}function r(e,n,t){var i=e.width*n,o=e.height*n;c.width=t*i,c.height=t*o,c.style.width=i,c.style.height=o}function d(e,n,t){var i="bold"===n?"bold ":"";t&&(i="italic "+i),u.ctx.font=i+e.fontSize+"pt "+e.font+", Helvetica, sans-serif"}function a(e){var i=n.parse(t.nomnomlSource),a=o(i.directives),l={setFont:d,textWidth:function(e){return u.ctx.measureText(e).width},textHeight:function(){return a.leading*a.fontSize}},c=n.layout(l,a,i);r(c,a.zoom,e),a.zoom*=e,n.render(u,a,c,d)}var l=e.devicePixelRatio||1,c=i[0],u=skanaar.Canvas(c,{});a(l)},template:"<canvas></canvas>",replace:!0}}e.module("ngNomnoml",[]),e.module("ngNomnoml").directive("nomnoml",["$window","$document",t])}(angular,nomnoml);