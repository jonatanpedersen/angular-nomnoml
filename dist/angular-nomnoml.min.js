!function(e,n){function o(e){return{restrict:"A",scope:{nomnomlSource:"@",nomnomlModel:"=nomnomlModel"},link:function(o,t){function i(e){return{arrowSize:+e.arrowSize||1,bendSize:+e.bendSize||.3,direction:{down:"TB",right:"LR"}[e.direction]||"TB",gutter:+e.gutter||5,edgeMargin:+e.edgeMargin||0,edges:{hard:"hard",rounded:"rounded"}[e.edges]||"rounded",fill:(e.fill||"#eee8d5;#fdf6e3;#eee8d5;#fdf6e3").split(";"),fillArrows:"true"===e.fillArrows,font:e.font||"Calibri",fontSize:+e.fontSize||12,leading:+e.leading||1.25,lineWidth:+e.lineWidth||3,padding:+e.padding||8,spacing:+e.spacing||40,stroke:e.stroke||"#33322E",zoom:+e.zoom||1}}function r(e,n,o){var t=e.width*n,i=e.height*n;c.width=o*t,c.height=o*i,c.style.width=t,c.style.height=i}function d(e,n,o){var t="bold"===n?"bold ":"";o&&(t="italic "+t),m.ctx.font=t+e.fontSize+"pt "+e.font+", Helvetica, sans-serif"}function l(e){var t=n.parse(o.nomnomlModel?o.nomnomlModel.toString():o.nomnomlSource),l=i(t.directives),a={setFont:d,textWidth:function(e){return m.ctx.measureText(e).width},textHeight:function(){return l.leading*l.fontSize}},c=n.layout(a,l,t);r(c,l.zoom,e),l.zoom*=e,n.render(m,l,c,d)}console.log(o);var a=e.devicePixelRatio||1,c=t[0],m=skanaar.Canvas(c,{});o.$watch("nomnomlModel",function(){l(a)}),l(a)},template:"<canvas></canvas>",replace:!0}}e.module("ngNomnoml",[]),e.module("ngNomnoml").directive("nomnoml",["$window","$document",o])}(angular,nomnoml);